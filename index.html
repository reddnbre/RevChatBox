<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>RevChattyBox - Gaming Chat Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="revchattybox-modern.css">
</head>
<body class="rev-skin">
  <!-- Cookie Consent Banner -->
  <div id="cookieBanner" class="cookie-banner">
    <div class="cookie-content">
      <div class="cookie-text">
        <p>🍪 We use cookies to save your preferences and chat history. By continuing, you agree to our use of cookies.</p>
      </div>
      <div class="cookie-actions">
        <button id="cookieAccept" class="btn btn-primary">Accept</button>
        <button id="cookieDecline" class="btn btn-secondary">Decline</button>
      </div>
    </div>
  </div>

  <!-- Splash Screen -->
  <div id="splash" class="splash">
    <div class="splash-bg">
      <div class="blob"></div>
      <div class="blob"></div>
      <div class="blob"></div>
    </div>
    <div class="splash-card">
      <div class="splash-header">
        <div class="logo">🎮 RevChattyBox</div>
        <p class="tagline">Your Ultimate Gaming Chat Hub</p>
      </div>
      
      <div class="progress-section">
        <div class="progress-track">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-info">
          <span class="status-text" id="statusText">Initializing...</span>
          <span class="progress-percent" id="progressPercent">0%</span>
        </div>
      </div>
      
      <div class="progress-tips" id="progressTips">
        <div class="tip">🎯 Loading gaming features...</div>
        <div class="tip">🎨 Applying premium themes...</div>
        <div class="tip">🔧 Setting up chat system...</div>
        <div class="tip">🎮 Preparing game hub...</div>
        <div class="tip">⚡ Optimizing performance...</div>
        <div class="tip">🚀 Almost ready...</div>
        <div class="tip">✨ Welcome to RevChattyBox!</div>
      </div>
      
      <div class="splash-actions">
        <button id="enterBtn" class="btn btn-primary">Enter App</button>
        <button id="skipBtn" class="btn btn-secondary">Skip Loading</button>
      </div>
    </div>
  </div>

  <!-- Main Application -->
  <div id="app" class="app" style="display: none;">
    <!-- Top Ad Banner -->
    <header class="header">
      <div class="ad-banner top-ad ad-top">
        <div class="ad-placeholder">Ad Space - Top Banner</div>
      </div>
    </header>

    <!-- Main Layout -->
    <div class="main-layout">
      <!-- Left Sidebar with Ad -->
      <aside class="sidebar left-sidebar ad-side">
        <div class="ad-banner side-ad ad-left">
          <div class="ad-placeholder">Ad Space - Left Sidebar</div>
        </div>
      </aside>

      <!-- Main Chat Area -->
      <main class="main-content">
        <div class="chat-container">
          <div class="chat-header">
            <h1>🎮 RevChattyBox</h1>
            <div class="header-actions">
              <span id="displayName" class="display-name"></span>
              <span id="userCount" class="pill users"><span class="dot"></span><span id="status">offline</span></span>
              <button id="gameHubBtn" class="btn">Game Hub</button>
              <button id="themeToggleBtn" class="btn" aria-label="Toggle theme">🌙</button>
              <button id="pmBtn" class="btn ghost" aria-label="Private Message">PM</button>
            </div>
          </div>
          
          <div class="chat-messages" id="chatMessages">
            <div class="system-message">
              Welcome to RevChattyBox! Your gaming chat hub.
            </div>
          </div>
          
          <div class="composer-bar">
            <div class="composer ibox">
              <input type="text" id="messageInput" placeholder="Type your message..." maxlength="500">
              <button id="emojiBtn" class="btn btn-emoji" title="Add Emoji">😊</button>
              <button id="sendBtn" class="btn btn-primary send">Send</button>
            </div>
          </div>
        </div>
      </main>

      <!-- Right Sidebar with Ad -->
      <aside class="sidebar right-sidebar ad-side">
        <div class="ad-banner side-ad ad-right">
          <div class="ad-placeholder">Ad Space - Right Sidebar</div>
        </div>
      </aside>
    </div>

    <!-- Bottom Ad Banner -->
    <footer class="footer">
      <div class="ad-banner bottom-ad ad-bottom">
        <div class="ad-placeholder">Ad Space - Bottom Banner</div>
      </div>
    </footer>
  </div>

  <!-- Name Entry Modal -->
  <div id="nameEntryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Welcome to RevChattyBox!</h2>
      </div>
      <div class="modal-body">
        <form id="nameEntryForm">
          <div class="form-group">
            <label for="displayNameInput">Enter your display name:</label>
            <input type="text" id="displayNameInput" placeholder="Your name..." maxlength="20" required>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Continue</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Game Hub Modal -->
  <div id="gameHubModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>🎮 Game Hub</h2>
        <span class="close" onclick="GameManager.hideGameHub()">&times;</span>
      </div>
      <div class="modal-body">
        <div id="gameList" class="game-list">
          <!-- Games will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Game Modal -->
  <div id="gameModal" class="modal">
    <div class="modal-content game-modal">
      <div class="modal-header">
        <h2 id="gameTitle">Game</h2>
        <span class="close" onclick="GameManager.hideGameModal()">&times;</span>
      </div>
      <div class="modal-body">
        <div id="gameStatus" class="game-status">
          <!-- Game status will be shown here -->
        </div>
        <div id="gameContainer" class="game-container">
          <!-- Game content will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Emoji Picker Modal -->
  <div id="emojiPicker" class="emoji-picker">
    <div class="emoji-picker-content">
      <div class="emoji-picker-header">
        <h3>Choose an Emoji</h3>
        <span class="close" onclick="EmojiManager.hidePicker()">&times;</span>
      </div>
      <div class="emoji-grid">
        <!-- Emojis will be populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Simple Local Chat System -->
  <script>
    // Simple working chat system
    class SimpleChat {
      constructor() {
        this.messages = [];
        this.init();
      }

      init() {
        console.log('SimpleChat initialized');
        this.setupElements();
        this.setupEventListeners();
        this.loadMessages();
        this.updateStatus();
      }

      setupElements() {
        this.$messages = document.getElementById("chatMessages");
        this.$input = document.getElementById("messageInput");
        this.$name = document.getElementById("displayNameInput");
        this.$status = document.getElementById("status");
        this.$sendBtn = document.getElementById("sendBtn");

        // Name persistence
        this.$name.value = localStorage.getItem("revchat_name") || "";
      }

      setupEventListeners() {
        // Name change
        this.$name.addEventListener("change", () => {
          localStorage.setItem("revchat_name", this.$name.value.trim());
        });

        // Send button
        this.$sendBtn.addEventListener("click", (e) => {
          e.preventDefault();
          this.sendMessage();
        });

        // Enter key
        this.$input.addEventListener("keypress", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            this.sendMessage();
          }
        });
      }

      sendMessage() {
        const text = this.$input.value.trim();
        if (!text) return;

        const name = (this.$name.value || "Anonymous").slice(0, 24);
        const message = {
          id: Date.now(),
          text: text,
          name: name,
          timestamp: new Date()
        };

        // Add to local array
        this.messages.push(message);
        
        // Save to localStorage
        this.saveMessages();
        
        // Display message
        this.displayMessage(message);
        
        // Clear input
        this.$input.value = "";

        // Add bot response
        setTimeout(() => {
          const botMessages = [
            "Thanks for your message! 🎉",
            "Cool! 👍",
            "Nice one!",
            "I see what you mean!",
            "Interesting point!",
            "Great to hear from you!",
            "Awesome! 🚀"
          ];
          const randomBotMessage = botMessages[Math.floor(Math.random() * botMessages.length)];
          
          const botMessage = {
            id: Date.now() + 1,
            text: randomBotMessage,
            name: "ChatBot",
            timestamp: new Date()
          };

          this.messages.push(botMessage);
          this.saveMessages();
          this.displayMessage(botMessage);
        }, 1500 + Math.random() * 2000);
      }

      displayMessage(message) {
        const div = document.createElement("div");
        const isUser = message.name !== "ChatBot";
        div.className = `message ${isUser ? "user" : "bot"}`;
        
        const header = document.createElement("div");
        header.className = "message-header";
        
        const senderName = document.createElement("span");
        senderName.className = "sender-name";
        senderName.textContent = message.name;
        
        const time = document.createElement("span");
        time.className = "message-time";
        time.textContent = message.timestamp.toLocaleTimeString();
        
        header.appendChild(senderName);
        header.appendChild(time);
        
        const content = document.createElement("div");
        content.className = "message-content";
        content.textContent = message.text;
        
        div.appendChild(header);
        div.appendChild(content);
        
        // Keep system message at top
        const systemMsg = this.$messages.querySelector('.system-message');
        if (systemMsg && systemMsg.nextSibling) {
          this.$messages.insertBefore(div, systemMsg.nextSibling);
        } else {
          this.$messages.appendChild(div);
        }
        
        this.$messages.scrollTop = this.$messages.scrollHeight;
      }

      loadMessages() {
        try {
          const saved = localStorage.getItem("revchat_messages");
          if (saved) {
            this.messages = JSON.parse(saved);
            
            // Clear existing messages except system message
            const systemMsg = this.$messages.querySelector('.system-message');
            this.$messages.innerHTML = "";
            if (systemMsg) this.$messages.appendChild(systemMsg);
            
            // Display all messages
            this.messages.forEach(msg => {
              msg.timestamp = new Date(msg.timestamp);
              this.displayMessage(msg);
            });
          }
        } catch (err) {
          console.error("Error loading messages:", err);
        }
      }

      saveMessages() {
        // Keep only last 100 messages
        if (this.messages.length > 100) {
          this.messages = this.messages.slice(-100);
        }
        localStorage.setItem("revchat_messages", JSON.stringify(this.messages));
      }

      updateStatus() {
        this.$status.textContent = "online";
      }
    }

    // Initialize chat when page loads
    document.addEventListener('DOMContentLoaded', () => {
      window.chat = new SimpleChat();
    });
  </script>

  <!-- Load the rest of the app -->
  <script src="script.js"></script>
</body>
</html>